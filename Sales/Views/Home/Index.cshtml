@model AttendanceViewModel
@{
	ViewData["Page"] = "الرئيسية";
}
<!--begin::Content wrapper-->
<div class="d-flex flex-column flex-column-fluid">
	<!--begin::Toolbar-->
	<div id="kt_app_toolbar" class="app-toolbar pt-7 pt-lg-10 bg-light">
		<div id="kt_app_toolbar_container" class="app-container container-fluid d-flex align-items-stretch">
			<div class="app-toolbar-wrapper d-flex flex-stack flex-wrap gap-4 w-100">
				<div class="page-title d-flex align-items-center gap-1 me-3">
					<div class="symbol symbol-70px symbol-circle me-4">
						<img src="~/images/school-logo.png" alt="شعار المدرسة" />
					</div>
					<div class="d-flex flex-column justify-content-center">
						<h1 class="page-heading d-flex align-items-center text-dark fw-bold fs-3 m-0">
							<i class="ki-outline ki-home-2 fs-1 me-3"></i>
							@ViewData["Page"]
						</h1>
						<span class="text-muted fw-semibold fs-7">لوحة التحكم - نظام إدارة حضور الطلاب</span>
					</div>
				</div>
				<div class="d-flex align-items-center gap-2">
					<div class="badge badge-light-primary fs-7">
						<i class="ki-outline ki-calendar fs-6 me-1"></i>
						<span id="currentDate"></span>
					</div>
					<div class="badge badge-light-info fs-7">
						<i class="ki-outline ki-time fs-6 me-1"></i>
						<span id="currentTime"></span>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!--end::Toolbar-->
	<!--begin::Content-->
	<div id="kt_app_content" class="app-content flex-column-fluid">
		<div id="kt_app_content_container" class="app-container container-fluid">

			<!--begin::Attendance Stats-->
			<div class="row g-5 g-xl-10 mb-5 mb-xl-10">
				<!--begin::Present Card-->
				<div class="col-md-4">
					<div class="card card-flush h-md-100 shadow-sm">
						<div class="card-header pt-7">
							<div class="card-title">
								<h3 class="fw-bold text-gray-800">
									<i class="ki-outline ki-check-circle fs-2x text-success me-2"></i>
									عدد الحضور
								</h3>
							</div>
						</div>
						<div class="card-body d-flex flex-column justify-content-between pt-0">
							<div class="d-flex flex-column text-center mt-5">
								<span class="fw-bold fs-2tx text-success" id="presentCount">
									@Model.Present
								</span>
								<span class="text-gray-600 fw-semibold fs-6 mt-2">طالب حاضر</span>
							</div>
							<div class="progress h-8px bg-light-success mt-7">
								<div class="progress-bar bg-success" role="progressbar" id="presentProgress" style="width: 0%"></div>
							</div>
						</div>
					</div>
				</div>
				<!--end::Present Card-->
				<!--begin::Absent Card-->
				<div class="col-md-4">
					<div class="card card-flush h-md-100 shadow-sm">
						<div class="card-header pt-7">
							<div class="card-title">
								<h3 class="fw-bold text-gray-800">
									<i class="ki-outline ki-cross-circle fs-2x text-danger me-2"></i>
									عدد الغياب
								</h3>
							</div>
						</div>
						<div class="card-body d-flex flex-column justify-content-between pt-0">
							<div class="d-flex flex-column text-center mt-5">
								<span class="fw-bold fs-2tx text-danger" id="absentCount">
									@Model.Absent
								</span>
								<span class="text-gray-600 fw-semibold fs-6 mt-2">طالب غائب</span>
							</div>
							<div class="progress h-8px bg-light-danger mt-7">
								<div class="progress-bar bg-danger" role="progressbar" id="absentProgress" style="width: 0%"></div>
							</div>
						</div>
					</div>
				</div>
				<!--end::Absent Card-->
				<!--begin::Total Card-->
				<div class="col-md-4">
					<div class="card card-flush h-md-100 shadow-sm">
						<div class="card-header pt-7">
							<div class="card-title">
								<h3 class="fw-bold text-gray-800">
									<i class="ki-outline ki-profile-user fs-2x text-primary me-2"></i>
									إجمالي الطلاب
								</h3>
							</div>
						</div>
						<div class="card-body d-flex flex-column justify-content-between pt-0">
							<div class="d-flex flex-column text-center mt-5">
								<span class="fw-bold fs-2tx text-primary" id="totalStudents">
									@Model.TotalStudents
								</span>
								<span class="text-gray-600 fw-semibold fs-6 mt-2">إجمالي الطلاب</span>
							</div>
							<div class="d-flex justify-content-between align-items-center mt-7 pt-5 border-top border-gray-300">
								<span class="text-gray-600 fs-7">
									<i class="ki-outline ki-check-circle text-success me-1"></i>
									نسبة الحضور
								</span>
								<span class="fw-bold text-success fs-6" id="attendancePercentage">0%</span>
							</div>
						</div>
					</div>
				</div>
				<!--end::Total Card-->
			</div>
			<!--end::Attendance Stats-->

			<div class="row g-5 g-xl-10">
				<!--begin::Quick Actions-->
				<div class="col-xl-6">
					<div class="card card-flush h-md-100 shadow-sm">
						<div class="card-header border-0 pt-7">
							<h3 class="card-title align-items-start flex-column">
								<span class="card-label fw-bold text-gray-800">
									<i class="ki-outline ki-abstract-26 fs-2 text-primary me-2"></i>
									إجراءات سريعة
								</span>
								<span class="text-muted mt-1 fw-semibold fs-7">الوصول السريع للعمليات الأساسية</span>
							</h3>
						</div>
						<div class="card-body pt-5">
							<div class="d-grid gap-4">
								<a href="@Url.Action("AttendanceRegistration", "Home")"
								   class="btn btn-lg btn-light-primary d-flex align-items-center justify-content-between">
									<span class="d-flex align-items-center">
										<i class="ki-outline ki-calendar-tick fs-2x me-4"></i>
										<span class="d-flex flex-column align-items-start">
											<span class="fw-bold fs-4">تسجيل الحضور</span>
											<span class="text-muted fs-7">تسجيل حضور طلاب اليوم</span>
										</span>
									</span>
									<i class="ki-outline ki-arrow-left fs-2"></i>
								</a>

								<a href="@Url.Action("Reports", "Home")"
								   class="btn btn-lg btn-light-success d-flex align-items-center justify-content-between">
									<span class="d-flex align-items-center">
										<i class="ki-outline ki-chart-simple fs-2x me-4"></i>
										<span class="d-flex flex-column align-items-start">
											<span class="fw-bold fs-4">تقارير الحضور</span>
											<span class="text-muted fs-7">عرض التقارير والإحصائيات</span>
										</span>
									</span>
									<i class="ki-outline ki-arrow-left fs-2"></i>
								</a>

								<a href="@Url.Action("", "Student")"
								   class="btn btn-lg btn-light-info d-flex align-items-center justify-content-between">
									<span class="d-flex align-items-center">
										<i class="ki-outline ki-people fs-2x me-4"></i>
										<span class="d-flex flex-column align-items-start">
											<span class="fw-bold fs-4">إدارة الطلاب</span>
											<span class="text-muted fs-7">عرض وإدارة بيانات الطلاب</span>
										</span>
									</span>
									<i class="ki-outline ki-arrow-left fs-2"></i>
								</a>
							</div>
						</div>
					</div>
				</div>
				<!--end::Quick Actions-->
				<!--begin::Today's Summary-->
				<div class="col-xl-6">
					<div class="card card-flush h-md-100 shadow-sm">
						<div class="card-header border-0 pt-7">
							<h3 class="card-title align-items-start flex-column">
								<span class="card-label fw-bold text-gray-800">
									<i class="ki-outline ki-chart-pie-3 fs-2 text-success me-2"></i>
									ملخص اليوم
								</span>
								<span class="text-muted mt-1 fw-semibold fs-7">إحصائيات الحضور لهذا اليوم</span>
							</h3>
						</div>
						<div class="card-body pt-5">
							<div class="d-flex flex-center mb-10">
								<div class="position-relative" style="width: 200px; height: 200px;">
									<canvas id="attendanceChart"></canvas>
									<div class="position-absolute top-50 start-50 translate-middle text-center">
										<span class="fs-2tx fw-bold text-gray-800" id="chartPercentage">0%</span>
										<span class="d-block text-gray-600 fs-7">نسبة الحضور</span>
									</div>
								</div>
							</div>
							<div class="d-flex flex-column gap-5">
								<div class="d-flex align-items-center justify-content-between">
									<div class="d-flex align-items-center">
										<div class="symbol symbol-40px me-3">
											<div class="symbol-label bg-light-success">
												<i class="ki-outline ki-check fs-2x text-success"></i>
											</div>
										</div>
										<div>
											<span class="text-gray-800 fw-bold fs-6 d-block">الحضور</span>
											<span class="text-gray-500 fw-semibold fs-7">عدد الطلاب الحاضرين</span>
										</div>
									</div>
									<span class="badge badge-light-success fs-5 fw-bold" id="presentBadge">@Model.Present</span>
								</div>
								<div class="separator separator-dashed"></div>
								<div class="d-flex align-items-center justify-content-between">
									<div class="d-flex align-items-center">
										<div class="symbol symbol-40px me-3">
											<div class="symbol-label bg-light-danger">
												<i class="ki-outline ki-cross fs-2x text-danger"></i>
											</div>
										</div>
										<div>
											<span class="text-gray-800 fw-bold fs-6 d-block">المتأخرين</span>
											<span class="text-gray-500 fw-semibold fs-7">عدد الطلاب المتأخرين</span>
										</div>
									</div>
									<span class="badge badge-light-danger fs-5 fw-bold" id="absentBadge">@Model.Late</span>
								</div>

								<div class="separator separator-dashed"></div>
								<div class="d-flex align-items-center justify-content-between">
									<div class="d-flex align-items-center">
										<div class="symbol symbol-40px me-3">
											<div class="symbol-label bg-light-danger">
												<i class="ki-outline ki-cross fs-2x text-danger"></i>
											</div>
										</div>
										<div>
											<span class="text-gray-800 fw-bold fs-6 d-block">الغياب</span>
											<span class="text-gray-500 fw-semibold fs-7">عدد الطلاب الغائبين</span>
										</div>
									</div>
									<span class="badge badge-light-danger fs-5 fw-bold" id="absentBadge">@Model.Absent</span>
								</div>
							</div>
						</div>
					</div>
				</div>
				<!--end::Today's Summary-->
			</div>

		</div>
	</div>
	<!--end::Content-->
</div>
<!--end::Content wrapper-->
@section Scripts
{
	<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
	<script>
		// Update current time and date
		function updateDateTime() {
			const now = new Date();
			const timeString = now.toLocaleTimeString('ar-EG', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
			const dateString = now.toLocaleDateString('ar-EG', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });

			document.getElementById('currentTime').textContent = timeString;
			document.getElementById('currentDate').textContent = dateString;
		}

		updateDateTime();
		setInterval(updateDateTime, 1000);

		// Initialize data from model
		let totalStudents = @Model.TotalStudents;
		let presentCount = @Model.Present;
		let absentCount = @Model.Absent;

		// Calculate percentages
		function updateStatistics() {
			const presentPercentage = totalStudents > 0 ? Math.round((presentCount / totalStudents) * 100) : 0;
			const absentPercentage = totalStudents > 0 ? Math.round((absentCount / totalStudents) * 100) : 0;

			// Update progress bars
			document.getElementById('presentProgress').style.width = presentPercentage + '%';
			document.getElementById('absentProgress').style.width = absentPercentage + '%';

			// Update attendance percentage
			document.getElementById('attendancePercentage').textContent = presentPercentage + '%';
			document.getElementById('chartPercentage').textContent = presentPercentage + '%';
		}

		// Initialize Chart.js
		const ctx = document.getElementById('attendanceChart');
		const attendanceChart = new Chart(ctx, {
			type: 'doughnut',
			data: {
				labels: ['حاضر', 'غائب'],
				datasets: [{
					data: [presentCount, absentCount],
					backgroundColor: ['#50cd89', '#f1416c'],
					borderWidth: 0
				}]
			},
			options: {
				responsive: true,
				maintainAspectRatio: true,
				cutout: '75%',
				plugins: {
					legend: {
						display: false
					},
					tooltip: {
						enabled: true,
						rtl: true,
						textDirection: 'rtl'
					}
				}
			}
		});

		// Load fresh data from server
		function loadAttendanceData() {
			fetch('@Url.Action("GetTodayAttendanceStats", "Home")')
				.then(response => response.json())
				.then(data => {
					// Update values
					totalStudents = data.totalStudents;
					presentCount = data.present;
					absentCount = data.absent;

					// Update UI
					document.getElementById('presentCount').textContent = presentCount;
					document.getElementById('absentCount').textContent = absentCount;
					document.getElementById('totalStudents').textContent = totalStudents;
					document.getElementById('presentBadge').textContent = presentCount;
					document.getElementById('absentBadge').textContent = absentCount;

					// Update chart
					attendanceChart.data.datasets[0].data = [presentCount, absentCount];
					attendanceChart.update();

					// Update statistics
					updateStatistics();
				})
				.catch(error => {
					console.error('Error loading attendance data:', error);
				});
		}

		// Initial update
		updateStatistics();

		// Reload data every 30 seconds
		setInterval(loadAttendanceData, 30000);
	</script>
}



@* @model AttendanceViewModel
@{
	ViewData["Page"] = "الرئيسية";
}
<!--begin::Content wrapper-->
<div class="d-flex flex-column flex-column-fluid">
	<!--begin::Toolbar-->
	<div id="kt_app_toolbar" class="app-toolbar pt-7 pt-lg-10">
		<div id="kt_app_toolbar_container" class="app-container container-fluid d-flex align-items-stretch">
			<div class="app-toolbar-wrapper d-flex flex-stack flex-wrap gap-4 w-100">
				<div class="page-title d-flex flex-column justify-content-center gap-1 me-3">
					<h1 class="page-heading d-flex flex-column justify-content-center text-dark fw-bold fs-3 m-0">
						<i class="ki-outline ki-home-2 fs-1 me-3"></i>
						@ViewData["Page"]
					</h1>
					<span class="text-muted fw-semibold fs-7">لوحة التحكم - نظام إدارة حضور الطلاب</span>
				</div>
				<div class="d-flex align-items-center gap-2">
					<div class="badge badge-light-primary fs-7">
						<i class="ki-outline ki-calendar fs-6 me-1"></i>
						<span id="currentDate"></span>
					</div>
					<div class="badge badge-light-info fs-7">
						<i class="ki-outline ki-time fs-6 me-1"></i>
						<span id="currentTime"></span>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!--end::Toolbar-->
	<!--begin::Content-->
	<div id="kt_app_content" class="app-content flex-column-fluid">
		<div id="kt_app_content_container" class="app-container container-fluid">

			<!--begin::Attendance Stats-->
			<div class="row g-5 g-xl-10 mb-5 mb-xl-10">
				<!--begin::Present Card-->
				<div class="col-md-4">
					<div class="card card-flush h-md-100 shadow-sm">
						<div class="card-header pt-7">
							<div class="card-title">
								<h3 class="fw-bold text-gray-800">
									<i class="ki-outline ki-check-circle fs-2x text-success me-2"></i>
									عدد الحضور
								</h3>
							</div>
						</div>
						<div class="card-body d-flex flex-column justify-content-between pt-0">
							<div class="d-flex flex-column text-center mt-5">
								<span class="fw-bold fs-2tx text-success" id="presentCount">
									@Model.Present
								</span>
								<span class="text-gray-600 fw-semibold fs-6 mt-2">طالب حاضر</span>
							</div>
							<div class="progress h-8px bg-light-success mt-7">
								<div class="progress-bar bg-success" role="progressbar" id="presentProgress" style="width: 0%"></div>
							</div>
						</div>
					</div>
				</div>
				<!--end::Present Card-->
				<!--begin::Absent Card-->
				<div class="col-md-4">
					<div class="card card-flush h-md-100 shadow-sm">
						<div class="card-header pt-7">
							<div class="card-title">
								<h3 class="fw-bold text-gray-800">
									<i class="ki-outline ki-cross-circle fs-2x text-danger me-2"></i>
									عدد الغياب
								</h3>
							</div>
						</div>
						<div class="card-body d-flex flex-column justify-content-between pt-0">
							<div class="d-flex flex-column text-center mt-5">
								<span class="fw-bold fs-2tx text-danger" id="absentCount">
									@Model.Absent
								</span>
								<span class="text-gray-600 fw-semibold fs-6 mt-2">طالب غائب</span>
							</div>
							<div class="progress h-8px bg-light-danger mt-7">
								<div class="progress-bar bg-danger" role="progressbar" id="absentProgress" style="width: 0%"></div>
							</div>
						</div>
					</div>
				</div>
				<!--end::Absent Card-->
				<!--begin::Total Card-->
				<div class="col-md-4">
					<div class="card card-flush h-md-100 shadow-sm">
						<div class="card-header pt-7">
							<div class="card-title">
								<h3 class="fw-bold text-gray-800">
									<i class="ki-outline ki-profile-user fs-2x text-primary me-2"></i>
									إجمالي الطلاب
								</h3>
							</div>
						</div>
						<div class="card-body d-flex flex-column justify-content-between pt-0">
							<div class="d-flex flex-column text-center mt-5">
								<span class="fw-bold fs-2tx text-primary" id="totalStudents">
									@Model.TotalStudents
								</span>
								<span class="text-gray-600 fw-semibold fs-6 mt-2">إجمالي الطلاب</span>
							</div>
							<div class="d-flex justify-content-between align-items-center mt-7 pt-5 border-top border-gray-300">
								<span class="text-gray-600 fs-7">
									<i class="ki-outline ki-check-circle text-success me-1"></i>
									نسبة الحضور
								</span>
								<span class="fw-bold text-success fs-6" id="attendancePercentage">0%</span>
							</div>
						</div>
					</div>
				</div>
				<!--end::Total Card-->
			</div>
			<!--end::Attendance Stats-->

			<div class="row g-5 g-xl-10">
				<!--begin::Quick Actions-->
				<div class="col-xl-6">
					<div class="card card-flush h-md-100 shadow-sm">
						<div class="card-header border-0 pt-7">
							<h3 class="card-title align-items-start flex-column">
								<span class="card-label fw-bold text-gray-800">
									<i class="ki-outline ki-abstract-26 fs-2 text-primary me-2"></i>
									إجراءات سريعة
								</span>
								<span class="text-muted mt-1 fw-semibold fs-7">الوصول السريع للعمليات الأساسية</span>
							</h3>
						</div>
						<div class="card-body pt-5">
							<div class="d-grid gap-4">
								<a href="@Url.Action("AttendanceRegistration", "Home")"
								   class="btn btn-lg btn-light-primary d-flex align-items-center justify-content-between">
									<span class="d-flex align-items-center">
										<i class="ki-outline ki-calendar-tick fs-2x me-4"></i>
										<span class="d-flex flex-column align-items-start">
											<span class="fw-bold fs-4">تسجيل الحضور</span>
											<span class="text-muted fs-7">تسجيل حضور طلاب اليوم</span>
										</span>
									</span>
									<i class="ki-outline ki-arrow-left fs-2"></i>
								</a>

								<a href="@Url.Action("AttendanceReport", "Home")"
								   class="btn btn-lg btn-light-success d-flex align-items-center justify-content-between">
									<span class="d-flex align-items-center">
										<i class="ki-outline ki-chart-simple fs-2x me-4"></i>
										<span class="d-flex flex-column align-items-start">
											<span class="fw-bold fs-4">تقارير الحضور</span>
											<span class="text-muted fs-7">عرض التقارير والإحصائيات</span>
										</span>
									</span>
									<i class="ki-outline ki-arrow-left fs-2"></i>
								</a>

								<a href="@Url.Action("Index", "Student")"
								   class="btn btn-lg btn-light-info d-flex align-items-center justify-content-between">
									<span class="d-flex align-items-center">
										<i class="ki-outline ki-people fs-2x me-4"></i>
										<span class="d-flex flex-column align-items-start">
											<span class="fw-bold fs-4">إدارة الطلاب</span>
											<span class="text-muted fs-7">عرض وإدارة بيانات الطلاب</span>
										</span>
									</span>
									<i class="ki-outline ki-arrow-left fs-2"></i>
								</a>

							</div>
						</div>
					</div>
				</div>
				<!--end::Quick Actions-->
				<!--begin::Today's Summary-->
				<div class="col-xl-6">
					<div class="card card-flush h-md-100 shadow-sm">
						<div class="card-header border-0 pt-7">
							<h3 class="card-title align-items-start flex-column">
								<span class="card-label fw-bold text-gray-800">
									<i class="ki-outline ki-chart-pie-3 fs-2 text-success me-2"></i>
									ملخص اليوم
								</span>
								<span class="text-muted mt-1 fw-semibold fs-7">إحصائيات الحضور لهذا اليوم</span>
							</h3>
						</div>
						<div class="card-body pt-5">
							<div class="d-flex flex-center mb-10">
								<div class="position-relative" style="width: 200px; height: 200px;">
									<canvas id="attendanceChart"></canvas>
									<div class="position-absolute top-50 start-50 translate-middle text-center">
										<span class="fs-2tx fw-bold text-gray-800" id="chartPercentage">0%</span>
										<span class="d-block text-gray-600 fs-7">نسبة الحضور</span>
									</div>
								</div>
							</div>
							<div class="d-flex flex-column gap-5">
								<div class="d-flex align-items-center justify-content-between">
									<div class="d-flex align-items-center">
										<div class="symbol symbol-40px me-3">
											<div class="symbol-label bg-light-success">
												<i class="ki-outline ki-check fs-2x text-success"></i>
											</div>
										</div>
										<div>
											<span class="text-gray-800 fw-bold fs-6 d-block">الحضور</span>
											<span class="text-gray-500 fw-semibold fs-7">عدد الطلاب الحاضرين</span>
										</div>
									</div>
									<span class="badge badge-light-success fs-5 fw-bold" id="presentBadge">@Model.Present</span>
								</div>
								<div class="separator separator-dashed"></div>
								<div class="d-flex align-items-center justify-content-between">
									<div class="d-flex align-items-center">
										<div class="symbol symbol-40px me-3">
											<div class="symbol-label bg-light-danger">
												<i class="ki-outline ki-cross fs-2x text-danger"></i>
											</div>
										</div>
										<div>
											<span class="text-gray-800 fw-bold fs-6 d-block">الغياب</span>
											<span class="text-gray-500 fw-semibold fs-7">عدد الطلاب الغائبين</span>
										</div>
									</div>
									<span class="badge badge-light-danger fs-5 fw-bold" id="absentBadge">@Model.Absent</span>
								</div>
							</div>
						</div>
					</div>
				</div>
				<!--end::Today's Summary-->
			</div>

		</div>
	</div>
	<!--end::Content-->
</div>
<!--end::Content wrapper-->
@section Scripts
{
	<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
	<script>
		// Update current time and date
		function updateDateTime() {
			const now = new Date();
			const timeString = now.toLocaleTimeString('ar-EG', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
			const dateString = now.toLocaleDateString('ar-EG', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });

			document.getElementById('currentTime').textContent = timeString;
			document.getElementById('currentDate').textContent = dateString;
		}

		updateDateTime();
		setInterval(updateDateTime, 1000);

		// Initialize data from model
		let totalStudents = @Model.TotalStudents;
		let presentCount = @Model.Present;
		let absentCount = @Model.Absent;

		// Calculate percentages
		function updateStatistics() {
			const presentPercentage = totalStudents > 0 ? Math.round((presentCount / totalStudents) * 100) : 0;
			const absentPercentage = totalStudents > 0 ? Math.round((absentCount / totalStudents) * 100) : 0;

			// Update progress bars
			document.getElementById('presentProgress').style.width = presentPercentage + '%';
			document.getElementById('absentProgress').style.width = absentPercentage + '%';

			// Update attendance percentage
			document.getElementById('attendancePercentage').textContent = presentPercentage + '%';
			document.getElementById('chartPercentage').textContent = presentPercentage + '%';
		}

		// Initialize Chart.js
		const ctx = document.getElementById('attendanceChart');
		const attendanceChart = new Chart(ctx, {
			type: 'doughnut',
			data: {
				labels: ['حاضر', 'غائب'],
				datasets: [{
					data: [presentCount, absentCount],
					backgroundColor: ['#50cd89', '#f1416c'],
					borderWidth: 0
				}]
			},
			options: {
				responsive: true,
				maintainAspectRatio: true,
				cutout: '75%',
				plugins: {
					legend: {
						display: false
					},
					tooltip: {
						enabled: true,
						rtl: true,
						textDirection: 'rtl'
					}
				}
			}
		});

		// Load fresh data from server
		function loadAttendanceData() {
			fetch('@Url.Action("GetTodayAttendanceStats", "Home")')
				.then(response => response.json())
				.then(data => {
					// Update values
					totalStudents = data.totalStudents;
					presentCount = data.present;
					absentCount = data.absent;

					// Update UI
					document.getElementById('presentCount').textContent = presentCount;
					document.getElementById('absentCount').textContent = absentCount;
					document.getElementById('totalStudents').textContent = totalStudents;
					document.getElementById('presentBadge').textContent = presentCount;
					document.getElementById('absentBadge').textContent = absentCount;

					// Update chart
					attendanceChart.data.datasets[0].data = [presentCount, absentCount];
					attendanceChart.update();

					// Update statistics
					updateStatistics();
				})
				.catch(error => {
					console.error('Error loading attendance data:', error);
				});
		}

		// Initial update
		updateStatistics();

		// Reload data every 30 seconds
		setInterval(loadAttendanceData, 30000);
	</script>
} *@